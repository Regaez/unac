// Datastar Custom Bundle v1.0.0-RC.5 â€“ licensed to user c476360fa51a05da43ae631c0df106f8
var ze=/ðŸ–•JS_DSðŸš€/.source,de=ze.slice(0,5),Oe=ze.slice(4),R="datastar",Qe="Datastar-Request",Ze=1e3;var Ye=!1,pe="outer",Xe="inner",et="remove",Pe="replace",tt="prepend",nt="append",st="before",it="after",rt=pe,X="datastar-patch-elements",ee="datastar-patch-signals";Object.hasOwn||(Object.hasOwn=(e,t)=>Object.prototype.hasOwnProperty.call(Object(e),t));function ge(e){return e instanceof HTMLElement||e instanceof SVGElement}var te=e=>e!==null&&typeof e=="object"&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null);var me=e=>{let t={};for(let[n,s]of e){let i=n.split("."),o=i.pop(),r=i.reduce((a,c)=>a[c]??={},t);r[o]=s}return t};var ot=e=>e.trim()==="true",S=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([a-z])([0-9]+)/gi,"$1-$2").replace(/([0-9]+)([a-z])/gi,"$1-$2").toLowerCase(),V=e=>S(e).replace(/-./g,t=>t[1].toUpperCase()),ne=e=>S(e).replace(/-/g,"_"),rn=e=>V(e).replace(/(^.|(?<=\.).)/g,t=>t[0].toUpperCase()),at=e=>{try{return JSON.parse(e)}catch{return Function(`return (${e})`)()}},on={kebab:S,snake:ne,pascal:rn};function ye(e,t){for(let n of t.get("case")||[]){let s=on[n];s&&(e=s(e))}return e}var an="https://data-star.dev/errors";function ct(e,t,n={}){let s=new Error;s.name=`${R} ${e} error`;let i=ne(t),o=new URLSearchParams({metadata:JSON.stringify(n)}).toString(),r=JSON.stringify(n,null,2);return s.message=`${t}
More info: ${an}/${e}/${i}?${o}
Context: ${r}`,s}function De(e,t,n={}){let s={plugin:{name:e.plugin.name,type:e.plugin.type}};return ct("init",t,Object.assign(s,n))}function lt(e,t,n={}){let s={plugin:{name:e.plugin.name,type:e.plugin.type},element:{id:e.el.id,tag:e.el.tagName},expression:{rawKey:e.rawKey,key:e.key,value:e.value,fnContent:e.fnContent}};return ct("runtime",t,Object.assign(s,n))}var he=`${R}-signal-patch`;var ve=[],$e=[],Ae=0,be=0,ke=0,D,re=()=>{Ae++},oe=()=>{--Ae||(ht(),M())},j=e=>ln.bind(0,{previousValue:e,value_:e,flags_:1}),He=Symbol("computed"),gt=e=>{let t=cn.bind(0,{flags_:17,getter:e});return t[He]=1,t},mt=e=>{let t={fn_:e,flags_:2};D&&Ie(t,D);let n=L(t);re();try{t.fn_()}finally{oe(),L(n)}return St.bind(0,t)},yt=e=>{let t=L(void 0);try{return e()}finally{L(t)}},ht=()=>{for(;be<ke;){let e=$e[be];$e[be++]=void 0,Et(e,e.flags_&=-65)}be=0,ke=0},ut=e=>"getter"in e?vt(e):bt(e,e.value_),L=e=>{let t=D;return D=e,t},vt=e=>{let t=L(e);Tt(e);try{let n=e.value_;return n!==(e.value_=e.getter(n))}finally{L(t),Rt(e)}},bt=(e,t)=>(e.flags_=1,e.previousValue!==(e.previousValue=t)),Ne=e=>{let t=e.flags_;if(!(t&64)){e.flags_=t|64;let n=e.subs_;n?Ne(n.sub_):$e[ke++]=e}},Et=(e,t)=>{if(t&16||t&32&&xt(e.deps_,e)){let s=L(e);Tt(e),re();try{e.fn_()}finally{oe(),L(s),Rt(e)}return}t&32&&(e.flags_=t&-33);let n=e.deps_;for(;n;){let s=n.dep_,i=s.flags_;i&64&&Et(s,s.flags_=i&-65),n=n.nextDep_}},cn=e=>{let t=e.flags_;if(t&16||t&32&&xt(e.deps_,e)){if(vt(e)){let n=e.subs_;n&&Re(n)}}else t&32&&(e.flags_=t&-33);return D&&Ie(e,D),e.value_},ln=(e,...t)=>{if(t.length){let s=t[0];if(e.value_!==(e.value_=s)){e.flags_=17;let i=e.subs_;return i&&(un(i),Ae||ht()),!0}return!1}let n=e.value_;if(e.flags_&16&&bt(e,n)){let s=e.subs_;s&&Re(s)}return D&&Ie(e,D),n},St=e=>{let t=e.deps_;for(;t;)t=Te(t,e);let n=e.subs_;n&&Te(n),e.flags_=0},Ie=(e,t)=>{let n=t.depsTail_;if(n&&n.dep_===e)return;let s,i=t.flags_&4;if(i&&(s=n?n.nextDep_:t.deps_,s&&s.dep_===e)){t.depsTail_=s;return}let o=e.subsTail_;if(o&&o.sub_===t&&(!i||At(o,t)))return;let r=t.depsTail_=e.subsTail_={dep_:e,sub_:t,prevDep_:n,nextDep_:s,prevSub_:o};s&&(s.prevDep_=r),n?n.nextDep_=r:t.deps_=r,o?o.nextSub_=r:e.subs_=r},Te=(e,t=e.sub_)=>{let n=e.dep_,s=e.prevDep_,i=e.nextDep_,o=e.nextSub_,r=e.prevSub_;if(i?i.prevDep_=s:t.depsTail_=s,s?s.nextDep_=i:t.deps_=i,o?o.prevSub_=r:n.subsTail_=r,r)r.nextSub_=o;else if(!(n.subs_=o))if("getter"in n){let a=n.deps_;if(a){n.flags_=17;do a=Te(a,n);while(a)}}else"previousValue"in n||St(n);return i},un=e=>{let t=e.nextSub_,n;e:for(;;){let s=e.sub_,i=s.flags_;if(i&3&&(i&60?i&12?i&4?!(i&48)&&At(e,s)?(s.flags_=i|40,i&=1):i=0:s.flags_=i&-9|32:i=0:s.flags_=i|32,i&2&&Ne(s),i&1)){let o=s.subs_;if(o){e=o,o.nextSub_&&(n={value_:t,prev_:n},t=e.nextSub_);continue}}if(e=t){t=e.nextSub_;continue}for(;n;)if(e=n.value_,n=n.prev_,e){t=e.nextSub_;continue e}break}},Tt=e=>{e.depsTail_=void 0,e.flags_=e.flags_&-57|4},Rt=e=>{let t=e.depsTail_,n=t?t.nextDep_:e.deps_;for(;n;)n=Te(n,e);e.flags_&=-5},xt=(e,t)=>{let n,s=0;e:for(;;){let i=e.dep_,o=i.flags_,r=!1;if(t.flags_&16)r=!0;else if((o&17)===17){if(ut(i)){let a=i.subs_;a.nextSub_&&Re(a),r=!0}}else if((o&33)===33){(e.nextSub_||e.prevSub_)&&(n={value_:e,prev_:n}),e=i.deps_,t=i,++s;continue}if(!r&&e.nextDep_){e=e.nextDep_;continue}for(;s;){--s;let a=t.subs_,c=a.nextSub_;if(c?(e=n.value_,n=n.prev_):e=a,r){if(ut(t)){c&&Re(a),t=e.sub_;continue}}else t.flags_&=-33;if(t=e.sub_,e.nextDep_){e=e.nextDep_;continue e}r=!1}return r}},Re=e=>{do{let t=e.sub_,n=e.nextSub_,s=t.flags_;(s&48)===32&&(t.flags_=s|16,s&2&&Ne(t)),e=n}while(e)},At=(e,t)=>{let n=t.depsTail_;if(n){let s=t.deps_;do{if(s===e)return!0;if(s===n)break;s=s.nextDep_}while(s)}return!1},Ve=e=>{let t=k,n=e.split(".");for(let s of n){if(t==null||!Object.hasOwn(t,s))return;t=t[s]}return t},ft=Symbol("delete"),Ee=(e,t="")=>{let n=Array.isArray(e);if(n||te(e)){let s=n?[]:{};for(let o in e)s[o]=j(Ee(e[o],`${t+o}.`));let i=j(0);return new Proxy(s,{get(o,r){if(!(r==="toJSON"&&!Object.hasOwn(s,r)))return n&&r in Array.prototype?(i(),s[r]):typeof r=="symbol"?s[r]:((!Object.hasOwn(s,r)||s[r]()==null)&&(s[r]=j(""),M(t+r,""),i(i()+1)),s[r]())},set(o,r,a){let c=t+r;if(a===ft)Object.hasOwn(s,r)&&(delete s[r],M(c,ft),i(i()+1));else if(n&&r==="length"){let l=s[r]-a;if(s[r]=a,l>0){let u={};for(let f=a;f<s[r];f++)u[f]=null;M(t.slice(0,-1),u),i(i()+1)}}else Object.hasOwn(s,r)?a==null?s[r](null)&&M(c,null):Object.hasOwn(a,He)?(s[r]=a,M(c,"")):s[r](Ee(a,`${c}.`))&&M(c,a):a!=null&&(Object.hasOwn(a,He)?(s[r]=a,M(c,"")):(s[r]=j(Ee(a,`${c}.`)),M(c,a)),i(i()+1));return!0},deleteProperty(o,r){return Object.hasOwn(s,r)&&s[r](null)&&M(t+r,null),!0},ownKeys(){return i(),Reflect.ownKeys(s)},has(o,r){return i(),r in s}})}return e},M=(e,t)=>{if(e!==void 0&&t!==void 0&&ve.push([e,t]),!Ae&&ve.length){let n=me(ve);ve.length=0,document.dispatchEvent(new CustomEvent(he,{detail:n}))}},je=(e,{ifMissing:t}={})=>{re();for(let n in e)e[n]==null?t||delete k[n]:Mt(e[n],n,k,"",t);oe()},_t=(e,t={})=>je(me(e),t),Mt=(e,t,n,s,i)=>{if(te(e)){Object.hasOwn(n,t)&&(te(n[t])||Array.isArray(n[t]))||(n[t]={});for(let o in e)e[o]==null?i||delete n[t][o]:Mt(e[o],o,n[t],`${s+t}.`,i)}else i&&Object.hasOwn(n,t)||(n[t]=e)};function wt({include:e=/.*/,exclude:t=/(?!)/}={},n=k){let s=[],i=[[n,""]];for(;i.length;){let[o,r]=i.pop();for(let a in o){let c=r+a;te(o[a])?i.push([o[a],`${c}.`]):dt(e).test(c)&&!dt(t).test(c)&&s.push([c,Ve(c)])}}return me(s)}function dt(e){return typeof e=="string"?RegExp(e.replace(/^\/|\/$/g,"")):e}var k=Ee({}),se={},Se=[],Ct=[],ie=new Map,Le=null,q="";function Ft(e){q=e}function G(e){return q?`data-${q}-${e}`:`data-${e}`}function qe(...e){for(let t of e){let n={plugin:t,actions:se,root:k,filtered:wt,signal:j,computed:gt,effect:mt,mergePatch:je,mergePaths:_t,peek:yt,getPath:Ve,startBatch:re,endBatch:oe,initErr:0};if(n.initErr=De.bind(0,n),t.type==="action")se[t.name]=t;else if(t.type==="attribute")Se.push(t),t.onGlobalInit?.(n);else if(t.type==="watcher")t.onGlobalInit?.(n);else throw n.initErr("InvalidPluginType")}Se.sort((t,n)=>{let s=n.name.length-t.name.length;return s!==0?s:t.name.localeCompare(n.name)}),Ct=Se.map(t=>RegExp(`^${t.name}([A-Z]|_|$)`))}function xe(e){let t=`[${G("ignore")}]`;for(let n of e)if(!n.closest(t))for(let s in n.dataset)Ot(n,s,n.dataset[s])}function pt(e){for(let t of e){let n=ie.get(t);if(ie.delete(t)){for(let s of n.values())s();n.clear()}}}function Ge(e=document.body){queueMicrotask(()=>{xe([e]),xe(e.querySelectorAll("*")),Le||(Le=new MutationObserver(fn),Le.observe(e,{subtree:!0,childList:!0,attributes:!0}))})}function Ot(e,t,n){if(t.startsWith(q)){let s=V(q?t.slice(q.length):t),i=Se.find((o,r)=>Ct[r].test(s));if(i){let[o,...r]=s.slice(i.name.length).split(/__+/),a=!!o;a&&(o=V(o));let c=!!n,l={plugin:i,actions:se,root:k,filtered:wt,signal:j,computed:gt,effect:mt,mergePatch:je,mergePaths:_t,peek:yt,getPath:Ve,startBatch:re,endBatch:oe,initErr:0,el:e,rawKey:s,key:o,value:n,mods:new Map,runtimeErr:0,rx:0};l.initErr=De.bind(0,l),l.runtimeErr=lt.bind(0,l),(i.shouldEvaluate===void 0||i.shouldEvaluate===!0)&&(l.rx=dn(l));let u=i.keyReq||"allowed";if(a){if(u==="denied")throw l.runtimeErr(`${i.name}KeyNotAllowed`)}else if(u==="must")throw l.runtimeErr(`${i.name}KeyRequired`);let f=i.valReq||"allowed";if(c){if(f==="denied")throw l.runtimeErr(`${i.name}ValueNotAllowed`)}else if(f==="must")throw l.runtimeErr(`${i.name}ValueRequired`);if(u==="exclusive"||f==="exclusive"){if(a&&c)throw l.runtimeErr(`${i.name}KeyAndValueProvided`);if(!a&&!c)throw l.runtimeErr(`${i.name}KeyOrValueRequired`)}for(let p of r){let[y,...v]=p.split(".");l.mods.set(V(y),new Set(v.map(E=>E.toLowerCase())))}let d=i.onLoad(l);if(d){let p=ie.get(e);p?p.get(s)?.():(p=new Map,ie.set(e,p)),p.set(s,d)}}}}function fn(e){let t=`[${G("ignore")}]`;for(let{target:n,type:s,attributeName:i,addedNodes:o,removedNodes:r}of e)if(s==="childList"){for(let a of r)ge(a)&&(pt([a]),pt(a.querySelectorAll("*")));for(let a of o)ge(a)&&(xe([a]),xe(a.querySelectorAll("*")))}else if(s==="attributes"&&ge(n)&&!n.closest(t)){let a=V(i.slice(5)),c=n.getAttribute(i);if(c===null){let l=ie.get(n);l&&(l.get(a)?.(),l.delete(a))}else Ot(n,a,c)}}function dn(e){let t="",n=e.plugin||void 0;if(n?.returnsValue){let d=/(\/(\\\/|[^/])*\/|"(\\"|[^"])*"|'(\\'|[^'])*'|`(\\`|[^`])*`|\(\s*((function)\s*\(\s*\)|(\(\s*\))\s*=>)\s*(?:\{[\s\S]*?\}|[^;){]*)\s*\)\s*\(\s*\)|[^;])+/gm,p=e.value.trim().match(d);if(p){let y=p.length-1,v=p[y].trim();v.startsWith("return")||(p[y]=`return (${v});`),t=p.join(`;
`)}}else t=e.value.trim();t=t.replace(/\$\['([a-zA-Z_$\d][\w$]*)'\]/g,"$$$1").replace(/\$([a-zA-Z_\d]\w*(?:[.-]\w+)*)/g,(d,p)=>p.split(".").reduce((v,E)=>`${v}['${E}']`,"$")).replace(/\[(\$[a-zA-Z_\d]\w*)\]/g,(d,p)=>`[$['${p.slice(1)}']]`);let s=new Map,i=RegExp(`(?:${de})(.*?)(?:${Oe})`,"gm"),o=0;for(let d of t.matchAll(i)){let p=d[1],y=`dsEscaped${o++}`;s.set(y,p),t=t.replace(de+p+Oe,y)}let r=(d,p)=>`${d}${ne(p).replaceAll(/\./g,"_")}`,a=new Set,c=RegExp(`@(${Object.keys(se).join("|")})\\(`,"gm"),l=[...t.matchAll(c)],u=new Set,f=new Set;if(l.length){let d=`${R}Act_`;for(let p of l){let y=p[1],v=se[y];if(!v)continue;a.add(y);let E=r(d,y);t=t.replace(`@${y}(`,`${E}(`),u.add(E),f.add((...w)=>v.fn(e,...w))}}for(let[d,p]of s)t=t.replace(d,p);e.fnContent=t;try{let d=Function("el","$",...n?.argNames||[],...u,t);return(...p)=>{try{return d(e.el,k,...p,...f)}catch(y){throw e.runtimeErr("ExecuteExpression",{error:y.message})}}}catch(d){throw e.runtimeErr("GenerateExpression",{error:d.message})}}var Pt={type:"attribute",name:"attr",valReq:"must",returnsValue:!0,onLoad:({el:e,effect:t,key:n,rx:s})=>{let i=(c,l)=>{l===""||l===!0?e.setAttribute(c,""):l===!1||l==null?e.removeAttribute(c):typeof l=="string"?e.setAttribute(c,l):e.setAttribute(c,JSON.stringify(l))};n=S(n);let o=n?()=>{r.disconnect();let c=s();i(n,c),r.observe(e,{attributeFilter:[n]})}:()=>{r.disconnect();let c=s(),l=Object.keys(c);for(let u of l)i(u,c[u]);r.observe(e,{attributeFilter:l})},r=new MutationObserver(o),a=t(o);return()=>{r.disconnect(),a()}}};function W(e){if(!e||e.size<=0)return 0;for(let t of e){if(t.endsWith("ms"))return+t.replace("ms","");if(t.endsWith("s"))return+t.replace("s","")*1e3;try{return Number.parseFloat(t)}catch{}}return 0}function ae(e,t,n=!1){return e?e.has(t.toLowerCase()):n}function We(e,t){return(...n)=>{setTimeout(()=>{e(...n)},t)}}function pn(e,t,n=!1,s=!0){let i=0;return(...o)=>{i&&clearTimeout(i),n&&!i&&e(...o),i=setTimeout(()=>{s&&e(...o),i&&clearTimeout(i)},t)}}function gn(e,t,n=!0,s=!1){let i=!1;return(...o)=>{i||(n&&e(...o),i=!0,setTimeout(()=>{i=!1,s&&e(...o)},t))}}function Dt(e,t){let n=t.get("delay");if(n){let o=W(n);e=We(e,o)}let s=t.get("debounce");if(s){let o=W(s),r=ae(s,"leading",!1),a=!ae(s,"notrail",!1);e=pn(e,o,r,a)}let i=t.get("throttle");if(i){let o=W(i),r=!ae(i,"noleading",!1),a=ae(i,"trail",!1);e=gn(e,o,r,a)}return e}var Ke=!!document.startViewTransition;function _e(e,t){if(t.has("viewtransition")&&Ke){let n=e;e=(...s)=>document.startViewTransition(()=>n(...s))}return e}var ce=`${R}-fetch`,Lt="started",$t="finished",kt="error",Ht="retrying",Nt="retries-failed";function Me(e,t){document.addEventListener(ce,n=>{if(n.detail.type===e){let{argsRaw:s}=n.detail;t(s)}})}var It={type:"attribute",name:"on",keyReq:"must",valReq:"must",argNames:["evt"],onLoad:e=>{let{el:t,key:n,mods:s,rx:i,startBatch:o,endBatch:r}=e,a=t;s.has("window")&&(a=window);let c=f=>{f&&(s.has("prevent")&&f.preventDefault(),s.has("stop")&&f.stopPropagation(),e.evt=f),o(),i(f),r()};c=Dt(c,s),c=_e(c,s);let l={capture:s.has("capture"),passive:s.has("passive"),once:s.has("once")};if(s.has("outside")){a=document;let f=c;c=d=>{t.contains(d?.target)||f(d)}}let u=S(n);if(u=ye(u,s),(u===ce||u===he)&&(a=document),t instanceof HTMLFormElement&&u==="submit"){let f=c;c=d=>{d?.preventDefault(),f(d)}}return a.addEventListener(u,c,l),()=>{a.removeEventListener(u,c)}}};var Vt={type:"attribute",name:"onLoad",keyReq:"denied",valReq:"must",onLoad:({rx:e,mods:t,startBatch:n,endBatch:s})=>{let i=()=>{n(),e(),s()};i=_e(i,t);let o=0,r=t.get("delay");r&&(o=W(r),o>0&&(i=We(i,o))),i()}};var jt="none",qt="display",Gt={type:"attribute",name:"show",keyReq:"denied",valReq:"must",returnsValue:!0,onLoad:({el:e,effect:t,rx:n})=>{let s=()=>{i.disconnect(),n()?e.style.display===jt&&e.style.removeProperty(qt):e.style.setProperty(qt,jt),i.observe(e,{attributeFilter:["style"]})},i=new MutationObserver(s),o=t(s);return()=>{i.disconnect(),o()}}};var Wt={type:"attribute",name:"signals",returnsValue:!0,onLoad:({key:e,mods:t,rx:n,mergePatch:s,mergePaths:i})=>{let o=t.has("ifmissing");if(e)e=ye(e,t),i([[e,n()]],{ifMissing:o});else{let r=Object.assign({},n());s(r,{ifMissing:o})}}};var we=new WeakMap,Ce=(e,t)=>({type:"action",name:e,fn:async(n,s,i)=>{let{el:o}=n,r=i?.requestCancellation??"auto",a=r instanceof AbortController?r:new AbortController,c=r==="disabled";c||we.get(o)?.abort(),!c&&!(r instanceof AbortController)&&we.set(o,a);try{await mn(n,t,s,i,a.signal)}finally{we.get(o)===a&&we.delete(o)}}}),H=(e,t,n)=>document.dispatchEvent(new CustomEvent(ce,{detail:{type:e,el:t,argsRaw:n}})),Kt=e=>`${e}`.includes("text/event-stream"),mn=async({el:e,evt:t,filtered:n,runtimeErr:s},i,o,{selector:r,headers:a,contentType:c="json",filterSignals:{include:l=/.*/,exclude:u=/(^|\.)_/}={},openWhenHidden:f=!1,retryInterval:d=Ze,retryScaler:p=2,retryMaxWaitMs:y=3e4,retryMaxCount:v=10}={},E)=>{let w=i.toLowerCase(),$=()=>{};try{if(!o?.length)throw s("FetchNoUrlProvided",{action:w});let C={Accept:"text/event-stream, text/html, application/json",[Qe]:!0};c==="json"&&(C["Content-Type"]="application/json");let J=Object.assign({},C,a),F={method:i,headers:J,openWhenHidden:f,retryInterval:d,retryScaler:p,retryMaxWaitMs:y,retryMaxCount:v,signal:E,onopen:async g=>{g.status>=400&&H(kt,e,{status:g.status.toString()})},onmessage:g=>{if(!g.event.startsWith(R))return;let O=g.event,A={};for(let h of g.data.split(`
`)){let m=h.indexOf(" "),_=h.slice(0,m),b=h.slice(m+1);(A[_]||=[]).push(b)}let P=Object.fromEntries(Object.entries(A).map(([h,m])=>[h,m.join(`
`)]));H(O,e,P)},onerror:g=>{if(Kt(g))throw s("InvalidContentType",{url:o});g&&(console.error(g.message),H(Ht,e,{message:g.message}))}},x=new URL(o,document.baseURI),z=new URLSearchParams(x.search);if(c==="json"){let g=JSON.stringify(n({include:l,exclude:u}));i==="GET"?z.set(R,g):F.body=g}else if(c==="form"){let g=r?document.querySelector(r):e.closest("form");if(!g)throw s(r?"FetchFormNotFound":"FetchClosestFormNotFound",{action:w,selector:r});if(!g.checkValidity()){g.reportValidity(),$();return}let O=new FormData(g),A=e;if(e===g&&t instanceof SubmitEvent)A=t.submitter;else{let m=_=>_.preventDefault();g.addEventListener("submit",m),$=()=>g.removeEventListener("submit",m)}if(A instanceof HTMLButtonElement){let m=A.getAttribute("name");m&&O.append(m,A.value)}let P=g.getAttribute("enctype")==="multipart/form-data";P||(J["Content-Type"]="application/x-www-form-urlencoded");let h=new URLSearchParams(O);if(i==="GET")for(let[m,_]of h)z.append(m,_);else P?F.body=O:F.body=h}else throw s("FetchInvalidContentType",{action:w,contentType:c});H(Lt,e,{}),x.search=z.toString();try{await En(x.toString(),e,F)}catch(g){if(!Kt(g))throw s("FetchFailed",{method:i,url:o,error:g})}}finally{H($t,e,{}),$()}};async function yn(e,t){let n=e.getReader(),s=await n.read();for(;!s.done;)t(s.value),s=await n.read()}function hn(e){let t,n,s,i=!1;return function(r){t?t=bn(t,r):(t=r,n=0,s=-1);let a=t.length,c=0;for(;n<a;){i&&(t[n]===10&&(c=++n),i=!1);let l=-1;for(;n<a&&l===-1;++n)switch(t[n]){case 58:s===-1&&(s=n-c);break;case 13:i=!0;case 10:l=n;break}if(l===-1)break;e(t.subarray(c,l),s),c=n,s=-1}c===a?t=void 0:c&&(t=t.subarray(c),n-=c)}}function vn(e,t,n){let s=Ut(),i=new TextDecoder;return function(r,a){if(!r.length)n?.(s),s=Ut();else if(a>0){let c=i.decode(r.subarray(0,a)),l=a+(r[a+1]===32?2:1),u=i.decode(r.subarray(l));switch(c){case"data":s.data=s.data?`${s.data}
${u}`:u;break;case"event":s.event=u;break;case"id":e(s.id=u);break;case"retry":{let f=+u;Number.isNaN(f)||t(s.retry=f);break}}}}}var bn=(e,t)=>{let n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n},Ut=()=>({data:"",event:"",id:"",retry:void 0});function En(e,t,{signal:n,headers:s,onopen:i,onmessage:o,onclose:r,onerror:a,openWhenHidden:c,fetch:l,retryInterval:u=1e3,retryScaler:f=2,retryMaxWaitMs:d=3e4,retryMaxCount:p=10,overrides:y,...v}){return new Promise((E,w)=>{let $={...s},C;function J(){C.abort(),document.hidden||P()}c||document.addEventListener("visibilitychange",J);let F=0;function x(){document.removeEventListener("visibilitychange",J),window.clearTimeout(F),C.abort()}n?.addEventListener("abort",()=>{x(),E()});let z=l||window.fetch,g=i||(()=>{}),O=0,A=u;async function P(){C=new AbortController;try{let h=await z(e,{...v,headers:$,signal:C.signal});O=0,u=A,await g(h);let m=async(b,N,ue,I,...Fe)=>{let Q={[ue]:await N.text()};for(let Z of Fe){let fe=N.headers.get(`datastar-${S(Z)}`);if(I){let Y=I[Z];Y&&(fe=typeof Y=="string"?Y:JSON.stringify(Y))}fe&&(Q[Z]=fe)}H(b,t,Q),x(),E()},_=h.headers.get("Content-Type");if(_?.includes("text/html"))return await m(X,h,"elements",y,"selector","mode","useViewTransition");if(_?.includes("application/json"))return await m(ee,h,"signals",y,"onlyIfMissing");if(_?.includes("text/javascript")){let b=document.createElement("script"),N=h.headers.get("datastar-script-attributes");if(N)for(let[ue,I]of Object.entries(JSON.parse(N)))b.setAttribute(ue,I);b.textContent=await h.text(),document.head.appendChild(b),x();return}await yn(h.body,hn(vn(b=>{b?$["last-event-id"]=b:delete $["last-event-id"]},b=>{A=u=b},o))),r?.(),x(),E()}catch(h){if(!C.signal.aborted)try{let m=a?.(h)||u;window.clearTimeout(F),F=window.setTimeout(P,m),u=Math.min(u*f,d),++O>=p?(H(Nt,t,{}),x(),w("Max retries reached.")):console.error(`Datastar failed to reach ${e.toString()} retrying in ${m}ms.`)}catch(m){x(),w(m)}}}P()})}var Bt=Ce("get","GET");var Jt=Ce("post","POST");var en={type:"watcher",name:X,async onGlobalInit(e){Me(X,t=>{Ke&&t.useViewTransition?.trim()==="true"?document.startViewTransition(()=>zt(e,t)):zt(e,t)})}};function zt(e,{elements:t="",selector:n,mode:s=rt}){let{initErr:i}=e,o=t.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,""),r=/<\/html>/.test(o),a=/<\/head>/.test(o),c=/<\/body>/.test(o),l=new DOMParser().parseFromString(r||a||c?t:`<body><template>${t}</template></body>`,"text/html"),u=document.createDocumentFragment();if(r?u.appendChild(l.documentElement):a&&c?(u.appendChild(l.head),u.appendChild(l.body)):a?u.appendChild(l.head):c?u.appendChild(l.body):u=l.querySelector("template").content,!n&&(s===pe||s===Pe))for(let f of u.children){let d;if(f instanceof HTMLHtmlElement)d=document.documentElement;else if(f instanceof HTMLBodyElement)d=document.body;else if(f instanceof HTMLHeadElement)d=document.head;else if(d=document.getElementById(f.id),!d){console.error(i("NoTargetsFound",{id:f.id}));continue}Zt(e,s,f,[d])}else{let f=document.querySelectorAll(n);if(!f.length){console.error(i("NoTargetsFound",{selector:n}));return}Zt(e,s,u,f)}}var Be=new WeakSet;for(let e of document.querySelectorAll("script"))Be.add(e);function Qt(e){let t=e instanceof HTMLScriptElement?[e]:e.querySelectorAll("script");for(let n of t)if(!Be.has(n)){let s=document.createElement("script");for(let{name:i,value:o}of n.attributes)s.setAttribute(i,o);s.text=n.text,n.replaceWith(s),Be.add(s)}}function Zt({initErr:e},t,n,s){for(let i of s){let o=n.cloneNode(!0);if(t===et)i.remove();else if(t===pe||t===Xe)Sn(i,o,t),Qt(i);else if(Qt(o),t===Pe)i.replaceWith(o);else if(t===tt)i.prepend(o);else if(t===nt)i.append(o);else if(t===st)i.before(o);else if(t===it)i.after(o);else throw e("InvalidPatchMode",{mode:t})}}var K=new Map,T=new Map,U=new Set,le=new Set,B=document.createElement("div");B.hidden=!0;function Sn(e,t,n){let s=G("ignore-morph");if(e.hasAttribute(s)&&t instanceof HTMLElement&&t.hasAttribute(s)||e.parentElement?.closest(`[${s}]`))return;let i=document.createElement("div");i.append(t),document.body.insertAdjacentElement("afterend",B);let o=e.querySelectorAll("[id]");for(let{id:a,tagName:c}of o)K.has(a)?le.add(a):K.set(a,c);e.id&&(K.has(e.id)?le.add(e.id):K.set(e.id,e.tagName)),U.clear();let r=i.querySelectorAll("[id]");for(let{id:a,tagName:c}of r)U.has(a)?le.add(a):K.get(a)===c&&U.add(a);K.clear();for(let a of le)U.delete(a);le.clear(),T.clear(),Xt(n==="outer"?e.parentElement:e,o),Xt(i,r),tn(n==="outer"?e.parentElement:e,i,n==="outer"?e:null,e.nextSibling),B.remove()}function tn(e,t,n=null,s=null){e instanceof HTMLTemplateElement&&t instanceof HTMLTemplateElement&&(e=e.content,t=t.content),n??=e.firstChild;for(let i of t.childNodes){if(n&&n!==s){let r=Tn(i,n,s);if(r){if(r!==n){let a=n;for(;a&&a!==r;){let c=a;a=a.nextSibling,Je(c)}}Ue(r,i),n=r.nextSibling;continue}}let o=i.id;if(i instanceof Element&&U.has(o)){let r=window[o],a=r;for(;a=a.parentNode;){let c=T.get(a);c&&(c.delete(o),c.size||T.delete(a))}nn(e,r,n),Ue(r,i),n=r.nextSibling;continue}if(T.has(i)){let r=document.createElement(i.tagName);e.insertBefore(r,n),Ue(r,i),n=r.nextSibling}else{let r=document.importNode(i,!0);e.insertBefore(r,n),n=r.nextSibling}}for(;n&&n!==s;){let i=n;n=n.nextSibling,Je(i)}}function Tn(e,t,n){let s=null,i=e.nextSibling,o=0,r=0,a=T.get(e)?.size||0,c=t;for(;c&&c!==n;){if(Yt(c,e)){let l=!1,u=T.get(c),f=T.get(e);if(f&&u){for(let d of u)if(f.has(d)){l=!0;break}}if(l)return c;if(!s&&!T.has(c)){if(!a)return c;s=c}}if(r+=T.get(c)?.size||0,r>a||(s===null&&i&&Yt(c,i)&&(o++,i=i.nextSibling,o>=2&&(s=void 0)),c.contains(document.activeElement)))break;c=c.nextSibling}return s||null}function Yt(e,t){let n=e.id;return e.nodeType===t.nodeType&&e.tagName===t.tagName&&(!n||n===t.id)}function Je(e){T.has(e)?nn(B,e,null):e.parentNode?.removeChild(e)}var nn=Je.call.bind(B.moveBefore??B.insertBefore);function Ue(e,t){let n=t.nodeType;if(n===1){let s=G("ignore-morph");if(e.hasAttribute(s)&&t.hasAttribute(s))return e;if(e instanceof HTMLInputElement&&t instanceof HTMLInputElement&&t.type!=="file")t.getAttribute("value")!==e.getAttribute("value")&&(e.value=t.getAttribute("value")??"");else if(e instanceof HTMLTextAreaElement&&t instanceof HTMLTextAreaElement){let r=t.value;r!==e.value&&(e.value=r),e.firstChild&&e.firstChild.nodeValue!==r&&(e.firstChild.nodeValue=r)}let i=(t.getAttribute(G("preserve-attr"))??"").split(" ");for(let{name:r,value:a}of t.attributes)e.getAttribute(r)!==a&&!i.includes(S(r))&&e.setAttribute(r,a);let o=e.attributes;for(let r=o.length-1;r>=0;r--){let{name:a}=o[r];!t.hasAttribute(a)&&!i.includes(S(a))&&e.removeAttribute(a)}}return(n===8||n===3)&&e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),e.isEqualNode(t)||tn(e,t),e}function Xt(e,t){for(let n of t)if(U.has(n.id)){let s=n;for(;s&&s!==e;){let i=T.get(s);i||(i=new Set,T.set(s,i)),i.add(n.id),s=s.parentElement}}}var sn={type:"watcher",name:ee,onGlobalInit:e=>Me(ee,({signals:t="{}",onlyIfMissing:n=`${Ye}`})=>e.mergePatch(at(t),{ifMissing:ot(n)}))};qe(Pt,It,Vt,Gt,Wt,Bt,Jt,en,sn);Ge();export{Ge as apply,qe as load,Ft as setAlias};
